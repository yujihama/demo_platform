## 1. Implementation

### Backend Development (11 days)

- [ ] **1.0 環境準備** (0.5 days)
  - [ ] 1.0.1 `backend/requirements.txt` に `langchain-openai`, `langchain-core` を追加し、インストール

- [ ] **1.1 LLM抽象化レイヤーの実装** (2 days)
  - [ ] 1.1.1 `config/llm.yaml` を拡張し、OpenAIとAzure OpenAIのプロバイダー設定を追加
  - [ ] 1.1.2 `config/features.yaml` を更新し、`agents.use_mock` フラグを追加（デフォルトはtrue）
  - [ ] 1.1.3 `LLMFactory` を拡張し、LangChainを使用してLLMインスタンスを生成するロジックを実装
  - [ ] 1.1.4 リトライロジック（Exponential Backoff）を実装

- [ ] **1.2 エージェントの実装** (5 days)
  - [ ] 1.2.1 `agents` ディレクトリを作成し、各エージェントのクラスを定義
  - [ ] 1.2.2 エージェント1（要件分解）のプロンプトとPydanticモデルを実装
  - [ ] 1.2.3 エージェント2（アプリタイプ分類）のプロンプトとPydanticモデルを実装
  - [ ] 1.2.4 エージェント3（パーツ選択）のプロンプトとPydanticモデルを実装
  - [ ] 1.2.5 エージェント4（データフロー設計）のプロンプトとPydanticモデルを実装
  - [ ] 1.2.6 バリデーターエージェントのプロンプトとPydanticモデルを実装

- [ ] **1.3 UIパーツカタログの作成** (1 day)
  - [ ] 1.3.1 `config/ui_parts_catalog.yaml` を作成し、Phase 2でサポートする最小限のコンポーネントを定義
  - [ ] 1.3.2 各コンポーネントに、適用可能なアプリタイプとプロパティ定義を追加
  - [ ] 1.3.3 カタログを読み込むユーティリティ関数を実装

- [ ] **1.4 パイプラインの拡張** (2.5 days)
  - [ ] 1.4.1 `GenerationPipeline` にLLM処理とモック処理を切り替えるロジックを追加
  - [ ] 1.4.2 4つのエージェントとバリデーターを順次実行するパイプラインを実装
  - [ ] 1.4.3 バリデーションエラー発生時に、Agent 3にエラー詳細をフィードバックして最大3回再試行するロジックを実装。3回失敗した場合は、ユーザーに明示的にエラーを報告
  - [ ] 1.4.4 LLMエラー発生時に、リトライロジックを呼び出すように修正

### Frontend Development (2 days)

- [ ] **2.1 UIの拡張** (2 days)
  - [ ] 2.1.1 要件入力画面のテキストエリアを拡張し、より自由な入力に対応
  - [ ] 2.1.2 LLMエラー発生時に、バックエンドから返されたエラーメッセージを`ErrorBanner`に表示
  - [ ] 2.1.3 `use_mock` フラグをUIから切り替えられるようにする（開発者向け）

### Testing (3 days)

- [ ] **3.1 ユニットテスト** (1 day)
  - [ ] 3.1.1 各エージェントのユニットテストを作成（モックLLMを使用）

- [ ] **3.2 E2Eテストの拡張** (2 days)
  - [ ] 3.2.1 `test_ui_wizard.py` を拡張し、自然言語での要件入力に対応
  - [ ] 3.2.2 `test_cli_generate.py` を拡張し、自然言語での要件入力に対応
  - [ ] 3.2.3 LLMエラー発生時のE2Eテストを追加

## 2. Validation

- [ ] 4.1 少なくとも2つのアプリタイプ（TYPE_DOCUMENT_PROCESSOR、TYPE_VALIDATION）で動作することを検証
- [ ] 4.2 UI経由での自然言語要件入力によるアプリ生成が成功することを検証
- [ ] 4.3 CLI経由での自然言語要件入力によるアプリ生成が成功することを検証
- [ ] 4.4 LLMプロバイダーの切り替え（OpenAI ↔ Azure OpenAI）が動作することを検証
- [ ] 4.5 リトライロジックが期待通りに動作することを検証
- [ ] 4.6 バリデーションエラー時の再試行が最大3回まで行われることを検証

