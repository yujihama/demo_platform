## Phase 3 タスク一覧：LLM統合と最終化

PR #8とPR #18のマージにより、宣言的アーキテクチャの基盤（LLMエージェントと思考プロセス、汎用実行エンジンと動的UI）が完成しました。このフェーズでは、これら2つの強力なコンポーネントを統合し、ユーザーが自然言語でアプリケーションを生成・実行できる、一貫した体験を完成させます。

- **目標**: LLMエージェントパイプラインと宣言的実行エンジンを統合し、ユーザーが自然言語でアプリケーションを生成するための最終的なUIを実装し、エンドユーザーが簡単に実行できる形式でパッケージングとテストを完了させる。
- **完了条件**: ユーザーがチャットUIで「請求書からデータを抽出するアプリを作って」と指示すると、システムが`workflow.yaml`を生成し、ユーザーはその実行に必要なすべてを含むDockerパッケージをダウンロードできる。そのパッケージを`docker-compose up`で起動すると、指示通りのアプリケーションがブラウザで動作する。

---

### 3.1: バックエンド統合（LLMパイプラインと実行エンジンの接続）

**目的**: LLMエージェント（PR #8）が、実行エンジン（PR #18）で解釈可能な`workflow.yaml`を生成できるようにする。

| タスクNo. | タスク内容 | 担当 | 完了条件 |
| :--- | :--- | :--- | :--- |
| **3.1.1** | **LLM対話APIエンドポイントの作成** | バックエンド | `POST /api/generate/conversations`のような、ユーザープロンプトを受け取り、対話セッションを開始するエンドポイントを実装する。 |
| **3.1.2** | **`GenerationPipeline`の改修** | バックエンド | `GenerationPipeline`（LLMエージェント群）の最終出力を、検証済みの`workflow.yaml`文字列に変更する。 |
| **3.1.3** | **生成物の一時保存** | バックエンド | 生成された`workflow.yaml`をセッションIDに紐付けて、Redisまたはファイルシステムに一時保存する機構を実装する。 |
| **3.1.4** | **生成物取得APIの作成** | バックエンド | `GET /api/generate/conversations/{session_id}/workflow`のような、生成された`workflow.yaml`を取得するエンドポイントを実装する。 |

### 3.2: フロントエンド実装（LLM対話UI）

**目的**: ユーザーがLLMと対話しながら、アプリケーションを設計するための直感的なUIを構築する。

| タスクNo. | タスク内容 | 担当 | 完了条件 |
| :--- | :--- | :--- | :--- |
| **3.2.1** | **チャットUIコンポーネントの実装** | フロントエンド | ユーザーがプロンプトを入力し、LLMからの応答（質問や確認）を表示する、再利用可能なチャットUIコンポーネントを実装する。 |
| **3.2.2** | **対話ロジックの実装** | フロントエンド | チャットUIとバックエンドの対話API（3.1.1）を接続し、一連の対話（要件定義→YAML生成）を実行できるようにする。 |
| **3.2.3** | **生成完了とプレビュー表示** | フロントエンド | YAML生成が完了したら、その旨をユーザーに通知し、生成された`workflow.yaml`の簡易プレビューを表示する。 |
| **3.2.4** | **ダウンロードボタンの実装** | フロントエンド | ユーザーが最終成果物をダウンロードするためのボタンを実装し、バックエンドのパッケージングAPI（3.3.2）を呼び出す。 |

### 3.3: パッケージングと配布

**目的**: エンドユーザーが専門知識なしで、生成されたアプリケーションを実行できる形式を確立する。

| タスクNo. | タスク内容 | 担当 | 完了条件 |
| :--- | :--- | :--- | :--- |
| **3.3.1** | **配布用`docker-compose.yml`の作成** | バックエンド | `runtime-engine`, `runtime-ui`, `redis`のみを含む、エンドユーザー向けの汎用`docker-compose.yml`テンプレートを作成する。 |
| **3.3.2** | **パッケージングAPIの実装** | バックエンド | `workflow.yaml`、配布用`docker-compose.yml`、そして簡単な使い方を記した`README.md`を一つのzipファイルにアーカイブして返すAPIを実装する。 |
| **3.3.3** | **配布用`README.md`の作成** | バックエンド | `.env`の設定方法と`docker-compose up`コマンドの実行方法のみを記載した、シンプルな`README.md`テンプレートを作成する。 |

### 3.4: E2Eテストと最終化

**目的**: 新アーキテクチャ全体を通した品質を保証し、プロジェクトをクリーンな状態で完了させる。

| タスクNo. | タスク内容 | 担当 | 完了条件 |
| :--- | :--- | :--- | :--- |
| **3.4.1** | **E2Eテストシナリオの作成** | QA/テスト | 「自然言語プロンプト入力→YAML生成→ダウンロード→Docker起動→アプリ動作確認」という一連の流れをテストするPlaywrightのシナリオを作成する。 |
| **3.4.2** | **E2Eテストの自動実行** | QA/テスト | 作成したE2EテストをCI/CDパイプラインに組み込み、主要な変更時に自動実行されるようにする。 |
| **3.4.3** | **プロジェクトドキュメントの最終化** | 全員 | プロジェクト全体の`README.md`を、最終的なアーキテクチャと使い方を反映した内容に全面的に更新する。 |
| **3.4.4** | **コードのクリーンアップ** | 全員 | 旧アーキテクチャ（Jinja2テンプレートなど）に関連する、現在使用されていないすべてのコードとファイルをリポジトリから完全に削除する。 |
